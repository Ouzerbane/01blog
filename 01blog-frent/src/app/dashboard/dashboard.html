<div class="dashboard-container">
  <main>
    <!-- üîπ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ Ÿà ÿßŸÑÿ®Ÿàÿ≥ÿ™ÿßÿ™ -->
    <section class="stats">
      <div class="stats-header">
        <div class="card" (click)="openFollowers()">
          <h3>Followers</h3>
          <p>{{ followers }}</p>
        </div>

        <div class="card" (click)="openFollowing()">
          <h3>Following</h3>
          <p>{{ following }}</p>
        </div>

        <div class="card create-post" (click)="PopatPost()">
          <h3>‚ûï Create Post</h3>
        </div>
      </div>

      <!-- ‚úÖ ÿ®Ÿàÿ≥ÿ™ Ÿàÿßÿ≠ÿØ -->
      <div *ngFor="let post of posts" class="post-card">
        <p><small>By {{ post.author.username }} ({{ post.author.email }})</small></p>
        <p><small>{{ post.createdAt | date: 'short' }}</small></p>

        <!-- üîπ Ÿàÿ∂ÿπ ÿßŸÑÿπÿ±ÿ∂ -->
        <div *ngIf="!post.isEditing; else editMode">
          <h4>{{ post.title }}</h4>
          <p>{{ post.content }}</p>
          <img *ngIf="post.imageUrl" [src]="post.imageUrl" alt="Post image" />

          <!-- üîπ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ŸÅÿßÿπŸÑ -->
          <div class="post-actions">
            <button class="action-btn" (click)="likePost(post)">
              <span class="icon" [class.like]="post.like">‚ù§Ô∏è</span>
              <span class="count">{{ post.countLike}}</span>
            </button>

            <button class="action-btn" (click)="toggleComments(post)">
              <span class="icon">üí¨</span>
              <span class="count">{{ post.countCommets}}</span>
            </button>
          </div>

          <!-- üîπ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑŸÖÿßŸÑŸÉ -->
          <div class="owner-actions" *ngIf="post.canEditAndDelet">
            <button class="edit-btn" (click)="startEditing(post)">‚úèÔ∏è Edit</button>
            <button class="delete-btn" (click)="deletePost(post)">üóëÔ∏è Delete</button>
          </div>

          <!-- üîπ ŸÇÿ≥ŸÖ ÿßŸÑŸÉŸàŸÖŸÜÿ™ -->
          <div *ngIf="post.showComment" class="comment-section">
            <div *ngFor="let comment of post.comment" class="comment-card">
              <p>
                <strong>{{ comment.username }}</strong>
                <small>{{ comment.createdAt | date: 'short' }}</small>
              </p>
              <p>{{ comment.content }}</p>
            </div>

            <!-- üîπ ÿ•ÿ∂ÿßŸÅÿ© ŸÉŸàŸÖŸÜÿ™ ÿ¨ÿØŸäÿØ -->
            <div class="add-comment">
              <input type="text" [(ngModel)]="post.newComment" placeholder="Write a comment..." />
              <button (click)="addComment(post)">üí¨ Post</button>
            </div>
          </div>
        </div>

        <!-- üîπ Ÿàÿ∂ÿπ ÿßŸÑÿ™ÿπÿØŸäŸÑ -->
        <ng-template #editMode>
          <div class="edit-form">
            <input type="text" [(ngModel)]="post.editTitle" placeholder="Edit title" />
            <textarea [(ngModel)]="post.editContent" rows="4" placeholder="Edit content"></textarea>
            <div class="edit-actions">
              <button class="save-btn" (click)="savePost(post)">üíæ Save</button>
              <button class="cancel-btn" (click)="cancelEditing(post)">‚ùå Cancel</button>
            </div>
          </div>
        </ng-template>
      </div>

      <!-- üîπ Pagination -->
      <div class="pagination">
        <button (click)="changePage(page - 1)" [disabled]="page === 0">‚¨Ö Prev</button>
        <span>Page {{ page + 1 }}</span>
        <button (click)="changePage(page + 1)">Next ‚û°</button>
      </div>
    </section>

    <!-- üîπ Suggested users -->
    <section class="recent-activity">
      <h2>Suggested for you</h2>
      <div class="suggested-list">
        <div *ngFor="let user of suggested" class="suggested-user">
          <div class="user-info">
            <div class="avatar">{{ user.username.charAt(0).toUpperCase() }}</div>
            <span>{{ user.username }}</span>
          </div>
          <button class="follow-btn" [class.following]="user.followed" (click)="toggleFollow(user)">
            {{ user.followed ? 'Following' : 'Follow' }}
          </button>
        </div>
      </div>
    </section>
  </main>

  <!-- üîπ Followers Modal -->
  <div class="modal" *ngIf="showFollowers">
    <div class="modal-content">
      <h3>Followers</h3>
      <div class="suggested-list">
        <div *ngFor="let user of followersList" class="suggested-user">
          <div class="user-info">
            <div class="avatar">{{ user.username.charAt(0).toUpperCase() }}</div>
            <span>{{ user.username }}</span>
          </div>
          <button class="follow-btn" [class.following]="user.followed" (click)="toggleFollow(user)">
            {{ user.followed ? 'Following' : 'Follow' }}
          </button>
        </div>
      </div>
      <button class="close-btn" (click)="closeModal()">Close</button>
    </div>
  </div>

  <!-- üîπ Following Modal -->
  <div class="modal" *ngIf="showFollowing">
    <div class="modal-content">
      <h3>Following</h3>
      <div class="suggested-list">
        <div *ngFor="let user of followingList" class="suggested-user">
          <div class="user-info">
            <div class="avatar">{{ user.username.charAt(0).toUpperCase() }}</div>
            <span>{{ user.username }}</span>
          </div>
          <button class="follow-btn" [class.following]="user.followed" (click)="toggleFollow(user)">
            {{ user.followed ? 'Following' : 'Follow' }}
          </button>
        </div>
      </div>
      <button class="close-btn" (click)="closeModal()">Close</button>
    </div>
  </div>
</div>